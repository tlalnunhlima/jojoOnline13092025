<!DOCTYPE html>

<html lang="en">
  
<%- include('layouts/headers') -%>

<body>
    
    <%- include ('ejsFunction') %> <!--function javascript ejs-->
    
<main class="container">
  
  <div class="mt-4">
            <a href="stdList" class="small text-secondary"> <i class="fas fa-arrow-left"></i> Back</i> </a>
  </div>
  
<div class="lead text-primary text-center fw-bold m-3"><i class="fas fa-check bgGradientBlue text-white border p-1 fs-6"></i> <%= viewTitle %></div>
<!--std list-->

<div class="table-responsive">
  
<table class="table border bg-white shadow-sm">
  
  <thead class="bg-white">
    
    <tr>
      
      <th scope="col" class="ps-3 orangeColor fw-normal" style="width: 85px">Regn.</th>
      
      <th scope="col" class="orangeColor fw-normal">Name of Student</th>
      
      <th scope="col" class="orangeColor fw-normal">Father's Name</th>
      
      <th scope="col" class="orangeColor fw-normal">Address </th>
      
      <th scope="col" class="orangeColor fw-normal">Phone No</th>
      
      <th scope="col" class="orangeColor fw-normal">Assignment</th>
      
      <th scope="col" class="orangeColor fw-normal">Action</th>
      
    </tr>
    
  </thead>
  
  <tbody>
  <% if (Array.isArray(students) && students.length) { %>
    <% const currentYear = new Date().getFullYear(); %>
    <% students.forEach(function(s) { %>
      <tr>
        <th class="text-center fw-normal"><%= s.regn || '-' %></th>

        <td>
          <a href="/computer/<%= s._id %>">
            <%= s.username ? capitalizeFirstLetter(s.username) : 'Unnamed' %>
          </a>
          <% if (s.admissionYear) { %>
            <span class="ms-2 badge <%= s.admissionYear === currentYear ? 'bg-success' : 'bg-secondary' %>">
              <%= s.admissionYear === currentYear ? 'Current' : s.admissionYear %>
            </span>
          <% } %>
        </td>

        <td><%= s.fname ? capitalizeFirstLetter(s.fname) : '-' %></td>
        <td><%= s.address ? capitalizeFirstLetter(s.address) : '-' %></td>
        <td><%= s.phone || '-' %></td>

        <td class="ps-3">
          <a href="/assignment/checkScore/<%= s._id %>" class="text-muted">click here...</a>
        </td>

        <td>
          <a href="/editStudent/<%= s._id %>" aria-label="Edit <%= s.username || 'student' %>">
            <i class="fas fa-edit border border-muted p-1 text-muted rounded me-1"
               data-bs-toggle="tooltip" data-bs-placement="bottom" title="Edit"></i>
          </a>

          <% if (username === 'tmapuia') { %>
            <a href="/stdList/delete/<%= s._id %>"
               onclick="return confirm('Are you sure to delete <%= s.username || 'this' %> record?');"
               aria-label="Delete <%= s.username || 'student' %>">
              <i class="fas fa-trash-alt border p-1 text-danger rounded" aria-hidden="true"></i>
            </a>
          <% } %>
        </td>
      </tr>
    <% }); %>
  <% } else { %>
    <tr>
      <td colspan="7" class="text-center text-muted py-4">
        No students found.
        <% if (username === 'tmapuia') { %>
          <div class="mt-2">
            <a href="/register" class="btn btn-sm btn-outline-primary">Add Student</a>
          </div>
        <% } %>
      </td>
    </tr>
  <% } %>
</tbody>

  
</table>

</div>

</main>
    
    <%- include('layouts/scripts') -%>
    
    <%- include('layouts/footer') -%>

  </body>
  
 

  
</html>